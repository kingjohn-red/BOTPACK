{
  "version": 3,
  "names": [
    "any",
    "bind",
    "emit",
    "escape",
    "expand",
    "parse",
    "plugmaticListener",
    "traffic",
    "array",
    "Math",
    "floor",
    "random",
    "length",
    "installed",
    "published",
    "color",
    "gray",
    "red",
    "yellow",
    "green",
    "text",
    "replace",
    "string",
    "external",
    "stash",
    "stashed",
    "unstash",
    "here",
    "push",
    "match",
    "digits",
    "href",
    "protocol",
    "concat",
    "j",
    "len",
    "line",
    "lines",
    "m",
    "result",
    "columns",
    "plugins",
    "split",
    "$item",
    "item",
    "dialog",
    "markup",
    "render",
    "trouble",
    "append",
    "data",
    "bright",
    "column",
    "detail",
    "format",
    "installer",
    "more",
    "normal",
    "pub",
    "report",
    "showdetail",
    "name",
    "publish",
    "find",
    "obj",
    "plugin",
    "dependencies",
    "months",
    "ref",
    "status",
    "birth",
    "Date",
    "now",
    "toFixed",
    "ref1",
    "version",
    "npm",
    "factory",
    "category",
    "ref2",
    "pages",
    "ref3",
    "ref4",
    "join",
    "head",
    "index",
    "inventory",
    "retrieve",
    "map",
    "results",
    "window",
    "location",
    "host",
    "row",
    "$row",
    "choice",
    "choices",
    "update",
    "install",
    "indexOf",
    "css",
    "removeAttr",
    "show",
    "plugmatic",
    "$",
    "ajax",
    "type",
    "url",
    "JSON",
    "stringify",
    "contentType",
    "dataType",
    "success",
    "error",
    "close",
    "button",
    "versions",
    "reverse",
    "description",
    "done",
    "npmjs",
    "struct",
    "title",
    "synopsis",
    "toString",
    "getJSON",
    "authors",
    "bundle",
    "e",
    "$parent",
    "target",
    "parent",
    "html",
    "context",
    "pageKey",
    "plugmaticDialog",
    "console",
    "log",
    "remove",
    "showModal",
    "parents",
    "wiki",
    "lineup",
    "atKey",
    "getContext",
    "open",
    "pathname",
    "addEventListener",
    "event",
    "postMessage",
    "body",
    "origin",
    "shiftKey",
    "currentTarget",
    "on",
    "mouseenter",
    "mouseleave",
    "attr",
    "hide",
    "xhr",
    "responseJSON",
    "textEditor",
    "$page",
    "action",
    "keepLineup",
    "source",
    "opener",
    "_data",
    "_data$keepLineup",
    "_data$pageKey",
    "_data$title",
    "_data$context",
    "filter",
    "i",
    "el",
    "pageHandler",
    "doInternalLink",
    "where",
    "message",
    "module",
    "exports"
  ],
  "sources": [
    "plugmatic.coffee"
  ],
  "sourcesContent": [
    "\nany = (array) ->\n  array[Math.floor Math.random()*array.length]\n\ntraffic = (installed, published) ->\n  color =\n    gray:   '#ccc'\n    red:    '#f55'\n    yellow: '#fb0'\n    green:  '#0e0'\n\n  if installed? and published?\n    if installed == published\n      color.green\n    else\n      color.yellow\n  else\n    if published?\n      color.red\n    else\n      color.gray\n\nescape = (text) ->\n  text\n    .replace /&/g, '&amp;'\n    .replace /</g, '&lt;'\n    .replace />/g, '&gt;'\n\nexpand = (string) ->\n  stashed = []\n  stash = (text) ->\n    here = stashed.length\n    stashed.push text\n    \"〖#{here}〗\"\n  unstash = (match, digits) ->\n    stashed[+digits]\n  external = (match, href, protocol) ->\n    stash \"\"\"\\\"<a class=\"external\" target=\"_blank\" href=\"#{href}\" title=\"#{href}\" rel=\"nofollow\">#{escape href}</a>\\\"\"\"\"\n  string = string\n    .replace /〖(\\d+)〗/g, \"〖 $1 〗\"\n    .replace /\"((http|https|ftp):.*?)\"/gi, external\n  escape string\n    .replace /〖(\\d+)〗/g, unstash\n\n\nparse = (text) ->\n  result = {columns: [], plugins: []}\n  lines = (text || '').split /\\n+/\n  for line in lines\n    result.columns.push 'status'    if line.match /\\bSTATUS\\b/\n    result.columns.push 'name'      if line.match /\\bNAME\\b/\n    result.columns.push 'menu'      if line.match /\\bMENU\\b/\n    result.columns.push 'pages'     if line.match /\\bPAGES\\b/\n    result.columns.push 'service'   if line.match /\\bSERVICE\\b/\n    result.columns.push 'bundled'   if line.match /\\bBUNDLED\\b/\n    result.columns.push 'installed' if line.match /\\bINSTALLED\\b/\n    result.columns.push 'published' if line.match /\\bPUBLISHED\\b/\n    result.plugins.push m[1]        if m = line.match /^wiki-plugin-(\\w+)$/\n  if result.columns.length == 0\n    result.columns = if result.plugins.length == 0\n      ['name', 'pages', 'menu', 'bundled', 'installed']\n    else\n      ['status', 'name', 'pages', 'bundled', 'installed', 'published']\n  result\n\n\nemit = ($item, item) ->\n  markup = parse item.text\n  dialog = null\n  $item.append \"\"\"\n    <p style=\"background-color:#eee;padding:15px;\">\n      loading plugin details\n    </p>\n  \"\"\"\n\n  render = (data) ->\n    column = 'installed'\n    pub = (name) -> data.publish.find (obj) -> obj.plugin == name\n\n    format = (markup, plugin, dependencies) ->\n      name = plugin.plugin\n      months = if plugin.birth\n        ((Date.now() - plugin.birth) / 1000 / 3600 / 24 / 31.5 ).toFixed(0)\n      else\n        ''\n      status = ->\n        installed = plugin.package?.version\n        published = pub(name).npm?.version\n        traffic installed, published\n\n      result = [\"<tr class=row data-name=#{plugin.plugin}>\"]\n      for column in markup.columns\n        result.push switch column\n          when 'status'    then \"<td title=status style='text-align:center; color: #{status()}'>◉\"\n          when 'name'      then \"<td title=name> #{name}\"\n          when 'menu'      then \"<td title=menu> #{plugin.factory?.category || ''}\"\n          when 'pages'     then \"<td title=pages style='text-align:center;'>#{plugin.pages?.length || ''}\"\n          when 'service'   then \"<td title=service style='text-align:center;'>#{months}\"\n          when 'bundled'   then \"<td title=bundled> #{dependencies['wiki-plugin-'+name] || ''}\"\n          when 'installed' then \"<td title=installed> #{plugin.package?.version || ''}\"\n          when 'published' then \"<td title=published> #{pub(name).npm?.version || ''}\"\n      result.join \"\\n\"\n\n    report = (markup, plugins, dependencies) ->\n      retrieve = (name) ->\n        for plugin in plugins\n          return plugin if plugin.plugin == name\n        {plugin: name}\n      inventory = if markup.plugins.length > 0\n        markup.plugins.map retrieve\n      else\n        plugins\n      head = (\"<td style='font-size:75%; color:gray;'>#{column}\" for column in markup.columns).join \"\\n\"\n      result = (format markup, plugin, dependencies for plugin, index in inventory).join \"\\n\"\n      \"<center>\n        <p><img src='/favicon.png' width=16> <span style='color:gray;'>#{window.location.host}</span></p>\n        <table style=\\\"width:100%;\\\"><tr> #{head} #{result}</table>\n        <button class=restart>restart</button>\n      </center>\"\n\n    installer = (row, npm) ->\n      return \"<p>can't find wiki-plugin-#{row.plugin} in <a href=//npmjs.com target=_blank>npmjs.com</a></p>\" unless npm?\n      $row = $item.find \"table [data-name=#{row.plugin}]\"\n      installed = (update) ->\n        index = data.install.indexOf row\n        data.install[index] = row = update.row\n        $row.find(\"[title=status]\").css('color',traffic(update.installed, npm.version))\n        $row.find(\"[title=menu]\").text(row.factory?.category || '')\n        $row.find(\"[title=pages]\").text(row.pages?.length || '')\n        $row.find('[title=service]').text('0')\n        $row.find(\"[title=installed]\").text(row.package?.version || '')\n        $item.find('button.restart').removeAttr('disabled').show()\n\n      window.plugins.plugmatic.install = (version) ->\n        $.ajax\n          type: 'POST'\n          url: '/plugin/plugmatic/install'\n          data: JSON.stringify({version, plugin: row.plugin})\n          contentType: \"application/json; charset=utf-8\"\n          dataType: 'json'\n          success: installed\n          error: trouble\n        # http://stackoverflow.com/questions/2933826/how-to-close-jquery-dialog-within-the-dialog\n        $row.find(\"[title=status]\").css('color','white')\n        dialog.close()\n\n      array = (obj) -> if typeof obj is 'string' then [obj] else obj\n      choice = (version) ->\n        button = () -> \"<button onclick=window.plugins.plugmatic.install('#{version}')> install </button>\"\n        \"<tr> <td> #{version} <td> #{if version == row.package?.version then 'installed' else button()}\"\n      choices = (choice(version) for version in array(npm.versions).reverse())\n      \"<h3>#{npm.description}</h3> <p>Choose a version to install.</p> <table>#{choices.join \"\\n\"}\"\n\n    detail = (name, done) ->\n      row = data.install.find (obj) -> obj.plugin == name\n      text = (obj) -> return '' unless obj; (expand obj).replace(/\\n/g,'<br>')\n      struct = (obj) -> return '' unless obj; \"<pre>#{expand JSON.stringify obj, null, '  '}</pre>\"\n      pages = (obj) -> \"<p><b><a href=#>#{obj.title}</a></b><br>#{obj.synopsis}</p>\"\n      birth = (obj) -> if obj then (new Date obj).toString() else 'built-in'\n      npmjs = (more) -> $.getJSON \"/plugin/plugmatic/view/#{name}\", more\n      switch column\n        when 'status' then npmjs (npm) -> done installer row, npm\n        when 'name' then done text row.authors\n        when 'menu' then done struct row.factory\n        when 'pages' then done row.pages.map(pages).join('')\n        when 'service' then done birth row.birth\n        when 'bundled' then done struct data.bundle.data.dependencies\n        when 'installed' then done struct row.package\n        when 'published' then done struct pub(name).npm || ''\n        else done 'unexpected column'\n\n    showdetail = (e) ->\n      $parent = $(e.target).parent()\n      name = $parent.data('name')\n      detail name, (html) ->\n        console.log(column, name, $item, item)\n        if column is 'status'\n          # show dialog\n          $item.remove('dialog')\n          $item.append \"\"\"\n            <dialog>\n              #{html}\n            </dialog>\n          \"\"\"\n          dialog = $item.find('dialog')[0]\n          console.log('dialog', dialog)\n          dialog.showModal()\n        else  \n          # wiki.dialog \"#{name} plugin #{column}\", html || ''\n          pageKey = $item.parents('.page').data('key')\n          context = wiki.lineup.atKey(pageKey).getContext()\n          plugmaticDialog = window.open('/plugins/plugmatic/dialog/#', 'plugmatic', 'popup,height=600,width=800')\n          if plugmaticDialog.location.pathname isnt '/plugins/plugmatic/dialog/'\n            plugmaticDialog.addEventListener('load', (event) ->\n              plugmaticDialog.postMessage({ column, title: \"#{name} plugin #{column}\", body: html || '', pageKey, context }, window.origin))\n          else\n            plugmaticDialog.postMessage({ column, title: \"#{name} plugin #{column}\", body: html || '', pageKey, context }, window.origin)\n\n    more = (e) ->\n     if e.shiftKey\n       showdetail e\n\n    bright = (e) -> more(e); $(e.currentTarget).css 'background-color', '#f8f8f8'\n    normal = (e) -> $(e.currentTarget).css 'background-color', '#eee'\n\n    $item.find('p').html report markup, data.install, data.bundle.data.dependencies\n    $item.find('.row').on {\n      mouseenter: bright\n      mouseleave: normal\n    }\n    $item.find('p td').on 'click', (e) ->\n      column = $(e.target).attr('title')\n      showdetail e\n    $item.find('button.restart').hide().on 'click', (e) ->\n      $item.find('button.restart').attr(\"disabled\",\"disabled\")\n      $.ajax\n        type: 'POST'\n        url: '/plugin/plugmatic/restart'\n        success: ->\n          # poll for restart complete, then ...\n          # $item.find('button.restart').hide()\n        error: trouble\n\n  trouble = (xhr) -> \n    $item.find('p').html xhr.responseJSON?.error || 'server error'\n\n  if markup.plugins.length\n    $.ajax\n      type: 'POST'\n      url: '/plugin/plugmatic/plugins'\n      data: JSON.stringify(markup)\n      contentType: \"application/json; charset=utf-8\"\n      dataType: 'json'\n      success: render\n      error: trouble\n  else\n    $.ajax\n      url: '/plugin/plugmatic/plugins'\n      dataType: 'json'\n      success: render\n      error: trouble\n\nbind = ($item, item) ->\n  $item.on 'dblclick', () -> wiki.textEditor $item, item\n\nplugmaticListener = (event) ->\n  if not event.source.opener or event.source.location.pathname isnt '/plugins/plugmatic/dialog/'\n    return\n  console.log('plugmatic listerner', event)\n\n  { data } = event\n\n  action = data.action\n\n  switch action\n    when 'doInternalLink'\n      { keepLineup = false, pageKey=null, title=null, context=null } = data\n      $page = null\n      if pageKey isnt null\n        $page = if keepLineup then null else $('.page').filter((i,el) -> $(el).data('key') is pageKey )\n      wiki.pageHandler.context = context\n      wiki.doInternalLink(title, $page)\n      break\n    else\n      console.error({ where: 'plugmaticListener', message: \"unknown action\", data })\n\n\n\nif window?\n  if typeof window.plugmaticListener == 'undefined' or window.plugmaticListener == null\n    console.log('*** Plugmatic - Adding Message Listener')\n    window.plugmaticListener = plugmaticListener\n    window.addEventListener(\"message\", plugmaticListener)\n\nwindow.plugins.plugmatic = {emit, bind} if window?\nmodule.exports = {parse} if module?\n\n"
  ],
  "mappings": "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"
}